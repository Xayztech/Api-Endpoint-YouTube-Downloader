<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Xayz Api YTDL ‚Ä¢ Dev Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #020203;
            --sidebar: #0e0e11;
            --border: #27272a;
            --primary: #6d28d9;
            --accent: #d946ef;
            --text: #e4e4e7;
            --text-muted: #a1a1aa;
            --card: rgba(24, 24, 27, 0.6);
            --code: #111113;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            overflow-x: hidden; /* Mencegah geser kanan kiri */
            width: 100vw;
            min-height: 100vh;
        }

        /* --- LAYOUT SYSTEM (FIXED GLITCH) --- */
        .app-layout {
            display: flex;
            min-height: 100vh;
            width: 100%;
            position: relative;
        }

        /* SIDEBAR FIXED */
        .sidebar {
            width: 280px;
            height: 100vh;
            background: var(--sidebar);
            border-right: 1px solid var(--border);
            position: fixed;
            left: 0;
            top: 0;
            z-index: 999;
            transform: translateX(0);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            padding-top: 80px; /* Space for mobile header if needed */
        }

        /* MAIN CONTENT FLUID */
        .main-content {
            flex: 1;
            margin-left: 280px; /* Same as sidebar width */
            padding: 30px;
            width: calc(100% - 280px);
            max-width: 100%;
            transition: margin-left 0.3s ease, width 0.3s ease;
        }

        /* MOBILE RESPONSIVE FIXES */
        @media (max-width: 900px) {
            .sidebar { transform: translateX(-100%); width: 260px; }
            .sidebar.active { transform: translateX(0); box-shadow: 10px 0 50px rgba(0,0,0,0.5); }
            .main-content { margin-left: 0; width: 100%; padding: 20px; padding-top: 70px; }
        }

        /* HAMBURGER MENU (FIXED POSITION) */
        .hamburger-btn {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 10000; /* Super tinggi agar tidak tertutup */
            background: rgba(0,0,0,0.8);
            border: 1px solid var(--border);
            color: white;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            backdrop-filter: blur(10px);
        }
        
        @media (max-width: 900px) {
            .hamburger-btn { display: flex; align-items: center; justify-content: center; }
        }

        .hamburger-btn svg { width: 24px; height: 24px; stroke: white; stroke-width: 2.5; }

        /* OVERLAY GELAP SAAT SIDEBAR BUKA DI MOBILE */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 998;
            display: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .overlay.active { display: block; opacity: 1; }

        /* NAV ITEMS */
        .nav-group { padding: 0 20px; margin-bottom: 25px; }
        .nav-label { font-size: 11px; text-transform: uppercase; color: #52525b; font-weight: 800; margin-bottom: 10px; letter-spacing: 1px; }
        .nav-item {
            display: flex; align-items: center; gap: 10px;
            padding: 12px 15px;
            color: var(--text-muted);
            text-decoration: none;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 4px;
            cursor: pointer;
            transition: 0.2s;
            font-weight: 500;
        }
        .nav-item:hover, .nav-item.active { background: #18181b; color: white; }
        .nav-item.active { border-left: 3px solid var(--primary); background: linear-gradient(90deg, rgba(109, 40, 217, 0.1), transparent); }

        /* SECTIONS */
        .section { display: none; animation: fadeIn 0.3s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CARDS */
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
        }

        h1 { margin: 0 0 10px 0; font-weight: 800; letter-spacing: -1px; background: linear-gradient(to right, #fff, #a1a1aa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        p { color: var(--text-muted); line-height: 1.6; margin-top: 0; }
        
        input {
            width: 100%;
            background: #09090b;
            border: 1px solid var(--border);
            padding: 16px;
            border-radius: 12px;
            color: white;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 15px;
            outline: none;
            transition: 0.3s;
        }
        input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(109, 40, 217, 0.2); }

        .btn {
            width: 100%;
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.2s;
        }
        .btn:hover { background: #5b21b6; transform: translateY(-1px); }

        /* RESULT AREA */
        .result-box { margin-top: 30px; border-top: 1px solid var(--border); padding-top: 30px; }
        .res-header { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 25px; }
        .res-thumb { width: 100%; max-width: 320px; border-radius: 12px; object-fit: cover; aspect-ratio: 16/9; background: #222; }
        .res-info { flex: 1; }
        .badge { display: inline-block; padding: 4px 8px; font-size: 11px; font-weight: 700; border-radius: 4px; background: #27272a; margin-right: 5px; margin-bottom: 5px; border: 1px solid #3f3f46; }

        .dl-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
        .dl-btn {
            text-decoration: none;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 13px;
            font-weight: 700;
            display: block;
            transition: 0.2s;
            color: #fff;
        }
        .dl-btn.mp4 { background: #0ea5e9; } /* Blue for Video */
        .dl-btn.mp3 { background: #10b981; } /* Green for Audio */
        .dl-btn:hover { opacity: 0.9; transform: scale(0.98); }

        /* CODE TABS */
        .tabs { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .tab { background: transparent; border: 1px solid var(--border); color: var(--text-muted); padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 13px; }
        .tab.active { background: var(--primary); color: white; border-color: var(--primary); }
        .code-block { display: none; background: var(--code); padding: 20px; border-radius: 12px; border: 1px solid var(--border); overflow-x: auto; font-family: 'JetBrains Mono', monospace; font-size: 13px; color: #a5f3fc; }
        .code-block.active { display: block; }

    </style>
</head>
<body>

    <button class="hamburger-btn" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>

    <div class="overlay" onclick="closeSidebar()"></div>

    <div class="app-layout">
        <nav class="sidebar" id="sidebar">
            <div style="padding: 0 25px 25px 25px;">
                <h2 style="margin:0; font-size: 20px;">XAYZ API YTDL</h2>
            </div>

            <div class="nav-group">
                <div class="nav-label">TOOLS</div>
                <div class="nav-item active" onclick="nav('home')">üöÄ Downloader GUI</div>
                <div class="nav-item" onclick="nav('apikey')">üîë Get API Key</div>
            </div>

            <div class="nav-group">
                <div class="nav-label">DOCUMENTATION</div>
                <div class="nav-item" onclick="nav('docs-intro')">üìñ Introduction</div>
                <div class="nav-item" onclick="nav('docs-api')">üîå API Endpoints</div>
                <div class="nav-item" onclick="nav('docs-error')">‚ö†Ô∏è Error Handling</div>
            </div>

            <div class="nav-group">
                <div class="nav-label">CODE EXAMPLES</div>
                <div class="nav-item" onclick="nav('code-js-cjs')">JavaScript (Node.js CJS)</div>
                <div class="nav-item" onclick="nav('code-js-esm')">JavaScript (Node.js ESM)</div>
                <div class="nav-item" onclick="nav('code-py')">Python</div>
                <div class="nav-item" onclick="nav('code-php')">PHP</div>
                <div class="nav-item" onclick="nav('code-go')">Go (Golang)</div>
                <div class="nav-item" onclick="nav('code-curl')">Bash / cURL</div>
            </div>
        </nav>

        <main class="main-content">
            
            <div id="home" class="section active">
                <div class="card">
                    <h1>Xayz Downloader Engine</h1>
                    <p>Powered by XYCoolcraft</p>
                    <br>
                    <label style="font-size: 12px; font-weight: bold; color: var(--text-muted);">API ACCESS KEY</label>
                    <input type="text" id="inpKey" placeholder="sk-pro-...">
                    
                    <label style="font-size: 12px; font-weight: bold; color: var(--text-muted);">YOUTUBE LINK</label>
                    <input type="text" id="inpUrl" placeholder="https://www.youtube.com/watch?v=...">
                    
                    <button class="btn" onclick="processVideo()">INITIALIZE DOWNLOAD PROCESS</button>
                </div>

                <div id="loading" style="display:none; text-align:center; padding: 40px;">
                    <div style="width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.1); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                    <p>Connecting to Server Nodes...</p>
                    <style>@keyframes spin { to { transform: rotate(360deg); } }</style>
                </div>

                <div id="result" class="card" style="display:none;">
                    <div class="res-header">
                        <img id="thumb" src="" class="res-thumb">
                        <div class="res-info">
                            <h2 id="title" style="margin-top:0; font-size:18px;"></h2>
                            <div style="margin-bottom:10px;">
                                <span class="badge" id="author"></span>
                                <span class="badge" id="duration"></span>
                            </div>
                            <p style="font-size:12px;">‚ö° Processed by: <span id="server" style="color:var(--accent);"></span></p>
                        </div>
                    </div>

                    <h3 style="font-size:14px; margin-bottom:15px; text-transform:uppercase; color:var(--text-muted);">Available Formats</h3>
                    <div id="dl-container" class="dl-grid"></div>

                    <div style="margin-top:20px; border-top:1px solid var(--border); padding-top:10px;">
                        <h4 style="font-size:12px; color:var(--text-muted);">RAW JSON RESPONSE</h4>
                        <div style="background:#000; padding:10px; border-radius:8px; height:150px; overflow-y:auto; font-family:monospace; font-size:11px; color:#a5f3fc;">
                            <pre id="json-raw"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <div id="apikey" class="section">
                <h1>Get Access Key</h1>
                <p>Generate a free, unlimited API key to use in your applications.</p>
                <div class="card">
                    <button class="btn" onclick="genKey()">GENERATE NEW KEY</button>
                    <div id="keyBox" style="margin-top:20px; padding:15px; background:#111; border:1px solid var(--primary); border-radius:8px; font-family:monospace; color:var(--primary); display:none; word-break:break-all;"></div>
                    <p style="font-size:12px; margin-top:10px;">* Please save this key locally.</p>
                </div>
            </div>

            <div id="docs-intro" class="section">
                <h1>Introduction</h1>
                <div class="card">
                    <p>Welcome to the XAYZ YTDL API Documentation. This API allows developers to programmatically fetch direct download links for YouTube videos including MP4 (Video) and MP3 (Audio) formats.</p>
                    <ul style="line-height:2; color:var(--text-muted);">
                        <li><strong>Hybrid Engine:</strong> Automatically Download.</li>
                        <li><strong>Auto Conversion:</strong> Supports direct MP3 conversion.</li>
                        <li><strong>No Ads:</strong> Clean JSON response without ad redirects.</li>
                        <li><strong>CORS Enabled:</strong> Can be called from client-side Javascript.</li>
                    </ul>
                </div>
            </div>

            <div id="docs-api" class="section">
                <h1>API Endpoints</h1>
                <div class="card">
                    <div style="display:flex; align-items:center; gap:10px; background:#18181b; padding:10px; border-radius:8px; margin-bottom:20px;">
                        <span style="background:#6d28d9; padding:4px 8px; border-radius:4px; font-size:12px; font-weight:bold;">GET</span>
                        <code style="color:#fff;" id="url-display"></code>
                    </div>
                    
                    <h3>Query Parameters</h3>
                    <table style="width:100%; text-align:left; border-collapse:collapse; color:var(--text-muted); font-size:14px;">
                        <tr style="border-bottom:1px solid var(--border);">
                            <th style="padding:10px;">Param</th>
                            <th style="padding:10px;">Required</th>
                            <th style="padding:10px;">Description</th>
                        </tr>
                        <tr>
                            <td style="padding:10px; color:var(--primary);">url</td>
                            <td style="padding:10px;">Yes</td>
                            <td style="padding:10px;">The full YouTube video URL.</td>
                        </tr>
                        <tr>
                            <td style="padding:10px; color:var(--primary);">apikey</td>
                            <td style="padding:10px;">Yes</td>
                            <td style="padding:10px;">Your access key.</td>
                        </tr>
                    </table>

                    <br>
                    <h3>Response Structure (JSON)</h3>
<pre class="code-block active">
{
  "status": true,
  "code": 200,
  "server_used": "Xayz Tech",
  "data": {
    "id": "2M9UOPNQkUw",
    "title": "BATTLE UNDER A BROKEN SKY",
    "author": "Xayz Prime",
    "duration": "77 seconds (1:17)",
    "thumbnail": "https://...",
    "downloads": [
      {
        "type": "video_auto",
        "quality": "Auto",
        "format": "mp4",
        "url": "https://your-domain/api/youtube?action=stream..." 
      },
      {
        "type": "audio_auto",
        "quality": "Auto",
        "format": "mp3",
        "url": "https://your-domain/api/youtube?action=stream..." 
      }
    ]
  }
}
</pre>
                </div>
            </div>

            <div id="code-js-cjs" class="section">
                <h1>JavaScript (Node.js CommonJS)</h1>
                <p>Standard <code>require</code> syntax for older Node environments.</p>
                <div class="card">
<pre class="code-block active">
const axios = require('axios');

const API_URL = 'https://xayz-ytdl.vercel.app/api/youtube';
const API_KEY = 'xayztech-example';
const VIDEO_URL = 'https://youtu.be/dQw4w9WgXcQ';

async function download() {
    try {
        const response = await axios.get(API_URL, {
            params: { url: VIDEO_URL, apikey: API_KEY }
        });

        if(response.data.status) {
            console.log("Title:", response.data.data.title);
            console.log("Downloads:", response.data.data.downloads);
        }
    } catch (error) {
        console.error("Error:", error.message);
    }
}

download();
</pre>
                </div>
            </div>

            <div id="code-js-esm" class="section">
                <h1>JavaScript (Node.js ESM)</h1>
                <p>Modern <code>import</code> syntax (Module).</p>
                <div class="card">
<pre class="code-block active">
import axios from 'axios';

const API_URL = 'https://xayz-ytdl.vercel.app/api/youtube';
const API_KEY = 'xayztech-example';
const VIDEO_URL = 'https://youtu.be/dQw4w9WgXcQ';

try {
    const { data } = await axios.get(API_URL, {
        params: { url: VIDEO_URL, apikey: API_KEY }
    });

    if(data.status) {
        console.log(`Found: ${data.data.title}`);
        data.data.downloads.forEach(dl => {
            console.log(`[${dl.format}] ${dl.url}`);
        });
    }
} catch (err) {
    console.error("Fetch failed:", err.message);
}
</pre>
                </div>
            </div>
            
            <div id="code-php" class="section">
                <h1>PHP Integration</h1>
                <p>Using cURL or file_get_contents.</p>
                <div class="card">
<pre class="code-block active">
&lt;?php
$baseUrl = "https://xayz-ytdl.vercel.app/api/youtube";
$apiKey = "xayztech-example";
$videoUrl = "https://www.youtube.com/watch?v=dQw4w9WgXcQ";

$query = http_build_query(['url' => $videoUrl, 'apikey' => $apiKey]);

// Initialize cURL
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $baseUrl . '?' . $query);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($ch);
curl_close($ch);

$data = json_decode($response, true);

if ($data['status']) {
    echo "Video Found: " . $data['data']['title'];
} else {
    echo "Failed: " . $data['message'];
}
?&gt;
</pre>
                </div>
            </div>

            <div id="code-py" class="section"><h1>Python</h1><div class="card"><pre class="code-block active">import requests
# Code here...</pre></div></div>
            <div id="code-go" class="section"><h1>Go (Golang)</h1><div class="card"><pre class="code-block active">package main
// Code here...</pre></div></div>
            <div id="code-curl" class="section"><h1>Bash / cURL</h1><div class="card"><pre class="code-block active">curl "https://..."</pre></div></div>
            <div id="docs-error" class="section"><h1>Error Handling</h1><div class="card"><p>Standard HTTP codes...</p></div></div>

        </main>
    </div>

    <script>
        // INIT
        document.getElementById('url-display').innerText = window.location.origin + "/api/youtube";
        
        // SIDEBAR LOGIC
        const sidebar = document.getElementById('sidebar');
        const overlay = document.querySelector('.overlay');

        function toggleSidebar() {
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        function closeSidebar() {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        }

        // NAV LOGIC
        function nav(id) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            // Show target
            const target = document.getElementById(id);
            if(target) target.classList.add('active');
            
            // Highlight nav item
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            // Find the element that called this function if needed, or simple highlighting logic
            // (Simplified for this partner coding session)
            
            // Close sidebar on mobile
            if(window.innerWidth <= 900) closeSidebar();
        }

        // API KEY LOGIC
        function genKey() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let key = 'sk-pro-' + Array(24).fill(0).map(()=>chars[Math.floor(Math.random()*chars.length)]).join('');
            
            const box = document.getElementById('keyBox');
            box.style.display = 'block';
            box.innerText = key;
            localStorage.setItem('yt_api_key_v4', key);
            document.getElementById('inpKey').value = key;
        }

        // DOWNLOAD PROCESS LOGIC
        async function processVideo() {
            const url = document.getElementById('inpUrl').value;
            const key = document.getElementById('inpKey').value;
            const resArea = document.getElementById('result');
            const loader = document.getElementById('loading');

            if(!url || !key) return alert("Please fill URL and API Key");

            resArea.style.display = 'none';
            loader.style.display = 'block';

            try {
                const endpoint = `/api/youtube?url=${encodeURIComponent(url)}&apikey=${key}`;
                const req = await fetch(endpoint);
                const res = await req.json();

                loader.style.display = 'none';

                if(res.status) {
                    const d = res.data;
                    document.getElementById('title').innerText = d.title;
                    document.getElementById('author').innerText = d.author || 'Unknown';
                    document.getElementById('duration').innerText = d.duration;
                    document.getElementById('server').innerText = res.server_used;
                    document.getElementById('thumb').src = d.thumbnail;
                    
                    document.getElementById('json-raw').innerText = JSON.stringify(res, null, 2);

                    const con = document.getElementById('dl-container');
                    con.innerHTML = '';

                    d.downloads.forEach(dl => {
                        const a = document.createElement('a');
                        // Styling based on format
                        const isMp3 = dl.format.includes('mp3') || dl.type.includes('audio');
                        a.className = isMp3 ? 'dl-btn mp3' : 'dl-btn mp4';
                        a.target = '_blank';
                        a.href = dl.url;
                        
                        let icon = isMp3 ? 'üéµ' : 'üé¨';
                        let label = isMp3 ? 'AUDIO MP3' : 'VIDEO MP4';
                        
                        // Menangani Auto Download
                        if(dl.type.includes('_auto')) {
                           label += ' (Direct)';
                        }

                        a.innerHTML = `${icon} ${label}<br><span style="font-size:10px; opacity:0.8">${dl.quality}</span>`;
                        con.appendChild(a);
                    });

                    resArea.style.display = 'block';
                } else {
                    alert(res.message);
                }
            } catch(e) {
                loader.style.display = 'none';
                alert("Error connecting to backend");
            }
        }

        // Auto Load Key
        const saved = localStorage.getItem('yt_api_key_v4');
        if(saved) document.getElementById('inpKey').value = saved;
    </script>
</body>
</html>
